%title='Fab Magic'
<article>
	<h2>{{ title }}</h2>
	<time>16 November, 2005</time>
	<p>
	Recently Jamie and I did some fairly major refactoring of fab, our &quot;invented here&quot; <a href="http://www.python.org">Python</a> web framework. I think we made some interesting additions and I'm fairly excited about developing our future web applications with it.<br /><br />Most of the new features are supported by some pretty magic python hackery, which always evokes strong feelings of pride amongst programmers. I particularly like the uniform handling of <abbr title="Hypertext Transfer Protocol">HTTP</abbr> GET/POST and our so-called &quot;path arguments&quot;. Path arguments are really just segments of the requested <abbr title="Uniform Resource Locator">URL</abbr> that we treat as parameters -- this method usually looks a lot cleaner than GET arguments and can often accomplish the same thing. All of this is facilitated by our favorite <abbr title="Hypertext Transfer Protocol">HTTP</abbr> wrapper, <a href="http://www.cherrypy.org">CherryPy</a>, but I think the layers we've added on top of CherryPy are significant and helpful.<br /><br />This is probably best explained by a small example -- a blog. A request to read posts for today might look like this:<br /><br /><code>http://www.mrshoe.org/blog/2005/11/16</code><br /><br />Assuming this blog is kept entirely in memory fab can handle this request in a few lines.<br /><br /><code>class BlogPage(fab.FabPage):<br />&nbsp;&nbsp;&nbsp;template = blogTemplate<br />&nbsp;&nbsp;&nbsp;def control(self, page, year, month, day):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page.blogtext = blogdata[year][month][day]</code><br /><br />Now imagine you want to make a search phrase bold throughout the post. Such a request might look like this:<br /><br /><code>http://www.mrshoe.org/blog/2005/11/16?bold=python</code><br /><br />To handle this you could write:<br /><code><br />class BlogPage(fab.FabPage):<br />&nbsp;&nbsp;&nbsp;template = blogTemplate<br />&nbsp;&nbsp;&nbsp;def control(self, page, year, month, day, bold=''):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text = blogdata[year][month][day]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page.blogtext = text.replace(bold,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;strong&gt;%s&lt;/strong&gt;' % bold)</code><br /><br />This is a simple example, but it demonstrates the use of both path arguments and GET arguments. The interesting part is how fab <em>passes</em> these arguments to the application. They are passed to the <code>control</code> method. Path arguments are normal positional arguments (which are a direct analog to segments of the <abbr title="Uniform Resource Locator">URL</abbr>, really), and GET/POST arguments are keyword arguments (also a very natural mapping). It gets better. Fab is smart enough to know what you do and don't care about. Any arguments you specify in the <code>control</code> method's signature will get passed along. Anything else will be ignored. Any arguments you expect but are absent in the request are assigned the value of <code>None</code>. Initially this system struck me as being a little too magic, but in practice it's very useful. If someone requests<br /><br /><code>http://www.mrshoe.org/blog/2005/11/16?<br />&nbsp;&nbsp;&nbsp;&nbsp;bold=python&foo=bar</code><br /><br />I don't care about the <code>foo</code> argument. My control method doesn't use it for anything. If they request<br /><br /><code>http://www.mrshoe.org/blog/2005/11/16/baz?<br />&nbsp;&nbsp;&nbsp;&nbsp;bold=python&foo=bar</code><br /><br />I don't care about the <code>baz</code>. Why display an annoying error message? Just give them the blog post they're looking for. If, in the future, I decide to add more fields to the form, all I have to do is add more keyword arguments to the <code>control</code> method and voila, fab will pass along the relevant data -- no more, no less.<br /><br />I've been using this method for a couple weeks now and it has proven to be easier and more elegant than any web development I've done in the past.<br /><br />I hope I didn't just provide you all with a starting point for hacking MrShoe.org... of course you would never try something so sinister, right?
	</p>
</article>
%rebase view/base title=title
